{% set categories = data.category %}
{% set item = data.item %}
{% set user = data.user %}
{% set files = data.files %}
{% set status = data.status %}

<div class='mall-page'>	
	{% if item %}
		{% set title = 'Edit your item post' %}
	{% else %}
		{% set title = 'Sell your item now' %}
	{% endif %}
	<div class='title'>{{ title }}</div>
	{% include 'modules/mall/templates/error.html.twig' %}
	{% include 'modules/mall/templates/mall.admin.commands.html.twig' %}
	<section class="content mall-item-add">
		<form class='item-add-form' method='post' action='/mall/item/edit/submit'>
		
			<input type='hidden' name='fids' value=''>
			
			<input type='hidden' name='item_id' value='{{ input.item_id }}'>			
			<div class='description'>What are you selling?</div>
			<input type='text' name='title' placeholder='Item Title' value='{{ item.title.value }}' required>			
			<div class='description'>What is the name of the item?</div>
			<input type='text' name='name' placeholder='Item Name' value='{{ item.name.value }}' required>		
			<div class='description'>In what category does your item fall?</div>
			<div class='categories clearfix'>
			{% for category in categories %}	
			<select class='category' {{ loop.index == data.category_last_selected ? "name=category_id" }} depth='0' {{ loop.index == 1 ? 'required' }}>
				<option value=''>Category</option>				
				{% for c in category.entity %}
					<option value='{{ c.id.value }}' {{ category.selected == c.id.value ? 'selected' }}>{{ c.name.value }}</option>
				{% endfor %}
			</select>
			{% endfor %}
			</div>
			<div class='description'>Brand</div>
			<input type='text' name='brand' value='{{ item.brand.value }}'>
			<div class='note'>Ex) Samsung</div>
			<div class='description'>Model</div>
			<input type='text' name='model' value='{{ item.model.value }}'>
			<div class='note'>Ex) Galaxy S5</div>
			<div class='description'>Model Year</div>
			<input type='number' name='model_year' value='{{ item.model_year.value }}'>			
			<div class='description'>Price</div>
			<div class='price-wrapper'>
				<span class='currency'>â‚±</span>
				<input type='number' name='price' value='{{ item.price.value }}' required>
			</div>
			<div class='note'>Item price must be within a realistic value range</div>
			<div class='description'>Phone Number</div>			
			{% if item.mobile.value %}
				{% set mobile = item.mobile.value %}
			{% else %}								
				{% set mobile = user.field_mobile.value %}				
			{% endif %}
			<input type='text' name='mobile' value='{{ mobile }}' required>
			<div class='note'>You can seperate phone numbers by using comma (,)</div>
			<div class='note'>Indicate the number where your buyer will contact you. Format: 09xxxxxxxxx (e.g. 09158787666)</div>
			<div class='description'>Location</div>
			<div class='location-wrapper clearfix'>
				<select class='location' name='province' required>
					<option value=''>Province</option>
					{% for p in data.provinces %}
						<option value='{{ p }}'{{ p == item.province.value ? " selected" }}>{{ p }}</option>
					{% endfor %}
				</select>			
				{% if item.city %}
					<select class='location' name='city' required>
						<option value=''>City</option>
						{% for k,v in data.cities %}
							<option value='{{ k }}'{{ k == item.city.value ? " selected" }}>{{ v }}</option>
						{% endfor %}
					</select>
				{% endif %}
			</div>
			<div class='description'>Meet ups</div>
			<input type='text' name='location' value='{{ item.location.value }}' required>
			<div class='note'>Places where you may do meetups.</div>
			<div class='note'>Please add them in an understandable way. In case of multiple places you may use comma (,) to separate it.</div>
			<div class='description'>What is the condition of your item?</div>
			<select name='status' required>
				<option value=''>Item Status</option>
				{% for k,v in status %}
					<option value='{{ k }}' {{ item.status.value == k ? 'selected' }}>{{ v }}</option>
				{% endfor %}				
			</select>
			<div class='description'>Description</div>
			<textarea name='content' required>{{ item.content.value }}</textarea>
			<div class='buttons'>
				<input class='item-add-submit' type='submit' value='Post Item'>
			</div>
		</form>
		
		
		
		
		
		
			<div class='file-upload-group item_image_thumbnail clearfix'>
				<div class='upload-label'>Item Image Thumbnail</div>
				<div class='upload item_image_thumbnail'>
					<form class="addForm-file-upload{{ files.item_image_thumbnail[0] ? ' is-hidden' }}" action="/mall/api?call=fileUpload" method="POST">
						<img class='fake' src='/modules/mall/img/fake_upload_photo.png'/>
						<fieldset><div class="row"><span class="value"><span class="element">
							<input type="hidden" name="call" value="fileUpload">
							<input type="hidden" name="image_style" value="medium">
							<input type='file' name='item_image_thumbnail' onchange="jQuery(this).parent().submit();">
						</span></span></div></fieldset>
					</form>
					<div class='display-uploaded-files clearfix'>
						{% if files.item_image_thumbnail[0] %}
						<div class='photo' fid='{{ files.item_image_thumbnail[0].fid }}'>
							<div class='delete'><span>X</span></div>
							<img src='{{ files.item_image_thumbnail[0].url_medium }}'>
						</div>
						{% endif %}
					</div>
				</div>
			</div>
			<div class='file-upload-group item_image clearfix'>
				<div class='upload-label'>Item Images</div>
			{% for i in 1..10 %}
				<div class='upload' no = '{{ i }}'>
					<form class="addForm-file-upload{{ files.item_image[i] ? ' is-hidden' }}" action="/mall/api?call=fileUpload" method="POST">
						<img class='fake' src='/modules/mall/img/fake_upload_photo.png'/>
						<fieldset><div class="row"><span class="value"><span class="element">
							<input type="hidden" name="call" value="fileUpload">
							<input type="hidden" name="image_style" value="medium">
							<input type="hidden" name="no" value="{{ i }}">
							<input type='file' name='item_image' onchange="jQuery(this).parent().submit();">
						</span></span></div></fieldset>
					</form>
					<div class='display-uploaded-files clearfix'>
						{% if files.item_image[i] %}
							<div class='photo' fid='{{ files.item_image[i].fid }}'>
								<div class='delete'><span>X</span></div>
								<img src='{{ files.item_image[i].url_medium }}'>
							</div>
						{% endif %}
					</div>
				</div>
			{% endfor %}
			</div>
			<div class='file-upload-group item_image_description clearfix'>
				<div class='upload-label'>Item Image Description</div>
				{% for i in 1..3 %}
					<div class='upload' no = '{{ i }}'>
						<form class="addForm-file-upload{{ files.item_image_description[i] ? ' is-hidden' }}" action="/mall/api?call=fileUpload" method="POST">
							<img class='fake' src='/modules/mall/img/fake_upload_photo.png'/>
							<fieldset><div class="row"><span class="value"><span class="element">
								<input type="hidden" name="call" value="fileUpload">
								<input type="hidden" name="image_style" value="medium">
								<input type="hidden" name="no" value="{{ i }}">
								<input type='file' name='item_image_description' onchange="jQuery(this).parent().submit();">
							</span></span></div></fieldset>
						</form>
						<div class='display-uploaded-files clearfix'>
							{% if files.item_image_description[i] %}
							<div class='photo' fid='{{ files.item_image_description[i].fid }}'>
								<div class='delete'><span>X</span></div>
								<img src='{{ files.item_image_description[i].url_medium }}'>
							</div>
							{% endif %}
						</div>
					</div>
				{% endfor %}
			</div>			
			<div class='buttons'>
				<div class='item-add-submit'>Post Item</div>
			</div>
	</section>
</div>